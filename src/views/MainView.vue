<template>

  <div class="main-content">
    <h1>Главная</h1>

    <RouterLink class="manage-button" to="/plans">
      <el-button type="primary">Управление</el-button>
    </RouterLink>
    
    <div class="day-selector">
      <div 
        v-for="dayName in days" 
        :class="{
          'active': currentDay === dayName,
          'circle': true,
        }"
        @click="selectDay(dayName)"
        :key="dayName"
      >
        <!-- circles -->
      </div>
    </div>
    <div class="day-content">
      <!-- excercises -->
      <div class="day-excercises">
        <span>{{ plan[currentDay]['тренировки']['тип тренировки'] }}</span>
        <el-checkbox
          v-for="(item, index) in plan[currentDay]['тренировки']['список упражнений']"
          v-model="exerciseChecks[index]"
          :key="index"
        >
          {{ item.название }} - {{ item['информация о выполнении'] }}
        </el-checkbox>
      </div>
      <!-- diet -->
      <div class="day-diet">
        <span class="diet-stats">
          {{ plan[currentDay]['питание']['суточная калорийность, БЖУ'] }}
        </span>
        <span
          v-for="(item, index) in plan[currentDay]['питание']['приемы пищи']"
          :key="index"
          class="diet-item"
        >
          {{ item.прием }}: {{ item.блюдо }} - {{ item['калории и БЖУ'] }}
        </span>
      </div>
    </div>

    <div class="stats-container">
      <img src="@/assets/stats.jpg" width="40%" />
    </div>
  </div>

</template>

<script setup>
import { ref } from 'vue';
import { useRouter } from 'vue-router';
import { useAuthStore } from '../stores/auth';

import { ElMessage } from 'element-plus';

const router = useRouter();
const authStore = useAuthStore();

const plan = ref({
  "Понедельник": {
    "тренировки": {
      "тип тренировки": "Силовая (грудь, спина)",
      "список упражнений": [
        {
          "название": "Отжимания",
          "информация о выполнении": "4 подхода по 15-20 повторений"
        },
        {
          "название": "Подтягивания/Тяга гантелей",
          "информация о выполнении": "4 подхода по 10-12 повторений"
        },
        {
          "название": "Планка",
          "информация о выполнении": "3 подхода по 60 секунд"
        }
      ]
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Овсянка с яйцом и овощами",
          "калории и БЖУ": "550 ккал (Б: 25г, Ж: 15г, У: 70г)"
        },
        {
          "прием": "обед",
          "блюдо": "Гречка с куриной грудкой и салатом",
          "калории и БЖУ": "700 ккал (Б: 50г, Ж: 20г, У: 80г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Творог с огурцом и зеленью",
          "калории и БЖУ": "450 ккал (Б: 40г, Ж: 15г, У: 30г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Яблоко и горсть миндаля",
          "калории и БЖУ": "300 ккал (Б: 10г, Ж: 20г, У: 25г)"
        }
      ]
    }
  },
  "Вторник": {
    "тренировки": {
      "тип тренировки": "Кардио",
      "список упражнений": [
        {
          "название": "Бег/Ходьба",
          "информация о выполнении": "40 минут в среднем темпе"
        },
        {
          "название": "Прыжки на скакалке",
          "информация о выполнении": "5 подходов по 2 минуты"
        }
      ]
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Омлет с овощами и тост из цельнозернового хлеба",
          "калории и БЖУ": "500 ккал (Б: 30г, Ж: 20г, У: 50г)"
        },
        {
          "прием": "обед",
          "блюдо": "Рис с тушеной индейкой и капустой",
          "калории и БЖУ": "750 ккал (Б: 45г, Ж: 25г, У: 85г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Запеченная рыба с овощами",
          "калории и БЖУ": "450 ккал (Б: 40г, Ж: 15г, У: 35г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Йогурт натуральный с ягодами",
          "калории и БЖУ": "300 ккал (Б: 15г, Ж: 10г, У: 35г)"
        }
      ]
    }
  },
  "Среда": {
    "тренировки": {
      "тип тренировки": "Отдых",
      "список упражнений": []
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Творожная запеканка с фруктами",
          "калории и БЖУ": "500 ккал (Б: 35г, Ж: 15г, У: 60г)"
        },
        {
          "прием": "обед",
          "блюдо": "Суп куриный с овощами и гречневый хлебец",
          "калории и БЖУ": "650 ккал (Б: 40г, Ж: 20г, У: 70г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Салат из тунца, яиц и овощей",
          "калории и БЖУ": "500 ккал (Б: 45г, Ж: 25г, У: 30г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Банан и арахисовая паста (1 ст.л.)",
          "калории и БЖУ": "250 ккал (Б: 8г, Ж: 12г, У: 30г)"
        }
      ]
    }
  },
  "Четверг": {
    "тренировки": {
      "тип тренировки": "Силовая (ноги, плечи)",
      "список упражнений": [
        {
          "название": "Приседания",
          "информация о выполнении": "4 подхода по 20 повторений"
        },
        {
          "название": "Выпады",
          "информация о выполнении": "3 подхода по 12 повторений на ногу"
        },
        {
          "название": "Подъем на носки",
          "информация о выполнении": "4 подхода по 25 повторений"
        }
      ]
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Гречневая каша с молоком и орехами",
          "калории и БЖУ": "600 ккал (Б: 25г, Ж: 20г, У: 80г)"
        },
        {
          "прием": "обед",
          "блюдо": "Запеченная курица с картофелем и морковью",
          "калории и БЖУ": "700 ккал (Б: 50г, Ж: 25г, У: 75г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Омлет с творогом и зеленью",
          "калории и БЖУ": "450 ккал (Б: 40г, Ж: 25г, У: 20г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Протеиновый коктейль на молоке",
          "калории и БЖУ": "300 ккал (Б: 30г, Ж: 10г, У: 25г)"
        }
      ]
    }
  },
  "Пятница": {
    "тренировки": {
      "тип тренировки": "Кардио + пресс",
      "список упражнений": [
        {
          "название": "Велосипед/Эллипс",
          "информация о выполнении": "30 минут"
        },
        {
          "название": "Скручивания",
          "информация о выполнении": "4 подхода по 20 повторений"
        },
        {
          "название": "Подъем ног лежа",
          "информация о выполнении": "3 подхода по 15 повторений"
        }
      ]
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Рисовая каша с изюмом и орехами",
          "калории и БЖУ": "550 ккал (Б: 20г, Ж: 15г, У: 80г)"
        },
        {
          "прием": "обед",
          "блюдо": "Индейка тушеная с булгуром и салатом",
          "калории и БЖУ": "750 ккал (Б: 55г, Ж: 25г, У: 75г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Кефир с отрубями и ягодами",
          "калории и БЖУ": "400 ккал (Б: 25г, Ж: 10г, У: 50г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Тост с авокадо и яйцом",
          "калории и БЖУ": "300 ккал (Б: 15г, Ж: 20г, У: 25г)"
        }
      ]
    }
  },
  "Суббота": {
    "тренировки": {
      "тип тренировки": "Силовая (руки, пресс)",
      "список упражнений": [
        {
          "название": "Отжимания узким хватом",
          "информация о выполнении": "4 подхода по 15 повторений"
        },
        {
          "название": "Обратные отжимания от стула",
          "информация о выполнении": "3 подхода по 12 повторений"
        },
        {
          "название": "Планка с подъемом рук",
          "информация о выполнении": "3 подхода по 40 секунд"
        }
      ]
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Сырники из творога с медом",
          "калории и БЖУ": "600 ккал (Б: 30г, Ж: 20г, У: 70г)"
        },
        {
          "прием": "обед",
          "блюдо": "Говядина тушеная с овощами и рисом",
          "калории и БЖУ": "800 ккал (Б: 50г, Ж: 30г, У: 80г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Салат из свеклы с куриной грудкой",
          "калории и БЖУ": "450 ккал (Б: 35г, Ж: 15г, У: 40г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Горький шоколад (30г) и кефир",
          "калории и БЖУ": "250 ккал (Б: 10г, Ж: 12г, У: 25г)"
        }
      ]
    }
  },
  "Воскресенье": {
    "тренировки": {
      "тип тренировки": "Отдых",
      "список упражнений": []
    },
    "питание": {
      "суточная калорийность, БЖУ": "2200 ккал (Б: 160г, Ж: 70г, У: 220г)",
      "приемы пищи": [
        {
          "прием": "завтрак",
          "блюдо": "Овсянка с бананом и орехами",
          "калории и БЖУ": "550 ккал (Б: 20г, Ж: 15г, У: 80г)"
        },
        {
          "прием": "обед",
          "блюдо": "Запеченный лосось с картофелем и спаржей",
          "калории и БЖУ": "750 ккал (Б: 50г, Ж: 35г, У: 60г)"
        },
        {
          "прием": "ужин",
          "блюдо": "Творог с огурцом и зеленью",
          "калории и БЖУ": "450 ккал (Б: 40г, Ж: 15г, У: 30г)"
        },
        {
          "прием": "перекус",
          "блюдо": "Фруктовый салат (яблоко, груша, йогурт)",
          "калории и БЖУ": "300 ккал (Б: 10г, Ж: 5г, У: 60г)"
        }
      ]
    }
  }
});

const days = [
  "Понедельник", "Вторник", "Среда", "Четверг", 
  "Пятница", "Суббота", "Воскресенье"
];

// Correct day calculation
const now = new Date();
const currentDay = ref(
  days[(now.getDay() - 1 + 7) % 7] // Fixes day offset
);

// Track exercise checks
const exerciseChecks = ref([]);

const selectDay = (day) => {
  currentDay.value = day;
  // Reset checks when changing day
  exerciseChecks.value = Array(plan.value[day].тренировки['список упражнений'].length).fill(false);
};

// Initialize checks for initial day
exerciseChecks.value = Array(
  plan.value[currentDay.value].тренировки['список упражнений'].length
).fill(false);

</script>

<style scoped>
.main-content {
  display: flex; 
  flex-direction: column;
  gap: 1em;
  align-items: center;
  position: relative;
}

.manage-button {
  position: absolute;
  top: 0;
  right: 0;
}

.day-selector {
  flex-grow: 0;
  display: flex;
  gap: 1em;
}

.day-content {
  display: flex;
  justify-content: center;
  gap: 1em;
  flex-grow: 1;
}

.day-excercises {
  border: 1px solid lightgray;
  border-radius: 5px;

  min-width: 45%;
  max-width: 45%;
  
  min-height: 400px;
  max-height: 400px;

  padding: 1em;

  display: flex;
  flex-direction: column;
/*  flex-grow: 1;*/
}

.day-diet {
  border: 1px solid lightgray;
  border-radius: 5px;
  min-width: 300px;
  min-height: 400px;

  min-width: 45%;
  max-width: 45%;
  
  min-height: 400px;
  max-height: 400px;

  padding: 1em;

  display: flex;
  flex-direction: column;
/*  flex-grow: 1;*/
}

.circle {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid lightgray;
}

.circle:not(.active):hover {
  cursor: pointer;
  background-color: #FEF9C7;
/*  border-color: #5EC9B1;*/
box-shadow: 0 0 6px 4px #FCE181;
}

.active {
  background-color: #FCE181;
  border: 1px solid #026670;
  box-shadow: 0 0 5px 8px #FEF9C7;
}

.main-content h1 {
  font-family: 'Inter';
  font-size: 36px;
  font-weight: bold;
}

.stats-container {
  display: flex;
  justify-content: center;
}

.diet-item {
  margin-bottom: 0.5em;
}

.diet-stats {
  font-weight: bold;
  font-size: 18px;
}
</style>